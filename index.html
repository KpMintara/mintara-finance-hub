<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mintara Finance Hub</title>

  <!-- Thirdâ€‘party libraries -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet"/>
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

  <!-- Compiled CSS & JS -->
  <link rel="stylesheet" href="css/styles.min.css">
  <script defer src="js/scripts.min.js"></script>

  <style>
    /* â”€ THEME VARIABLES â”€ */
    :root { /* unchanged */ }
    [data-theme="light"] { /* unchanged */ }

    /* â”€ GLOBAL RESET & BASE â”€ */
    * { /* unchanged */ }
    body { /* unchanged */ }
    a { /* unchanged */ }

    /* â”€ NAV â”€ */
    .top-nav { /* unchanged */ }
    .nav-left img { /* unchanged */ }
    .nav-right a, #theme-toggle { /* unchanged */ }
    .nav-right a:hover { /* unchanged */ }

    /* â”€ HERO â”€ */
    .hero { /* unchanged */ }
    .hero img { /* unchanged */ }
    .hero .text { /* unchanged */ }
    .hero h1 { /* unchanged */ }
    .hero p  { /* unchanged */ }
    .hero .cta-button { /* unchanged */ }
    .hero .cta-button:hover { /* unchanged */ }

    /* â”€ FEATURES â”€ */
    .features { /* unchanged */ }
    .feature-card { /* unchanged */ }
    .feature-card:hover { /* unchanged */ }
    .feature-card img { /* unchanged */ }
    .feature-card h3 { /* unchanged */ }
    .feature-card p  { /* unchanged */ }

    /* â”€ 3D FLIP SETUP â”€ */
    .flip-card { /* unchanged */ }
    .flip-card-inner { /* unchanged */ }
    .flip-card:hover .flip-card-inner { /* unchanged */ }
    .flip-card-front,
    .flip-card-back { /* unchanged */ }
    .flip-card-back { /* unchanged */ }
    .tool-btn { /* unchanged */ }
    .tool-btn:hover { /* unchanged */ }

    /* â”€ POPâ€‘UP CALCULATOR WINDOW â”€ */
    .tool-window { /* unchanged */ }
    .tool-window-header { /* unchanged */ }
    .tool-window-header button#minimize-tool { /* unchanged */ }
    .tool-window-header button#minimize-loan { /* unchanged */ }

    /* add this for NPV minimize spacing: */
    .tool-window-header button#minimize-npv {
      margin-left: auto;
      margin-right: .5rem;
    }

    .tool-window-header button { /* unchanged */ }
    .tool-window-content { /* unchanged */ }
    .tool-window-content form { /* unchanged */ }
    .tool-window-content input,
    .tool-window-content button { /* unchanged */ }
    .tool-window-content button:hover { /* unchanged */ }
    .tool-minimized { /* unchanged */ }
    .hidden { /* unchanged */ }

    /* â”€ TESTIMONIALS â”€ */
    .testimonials { /* unchanged */ }
    /* ...rest of CSS unchanged... */
  </style>
</head>

<body data-theme="dark">
  <nav class="top-nav">
    <div class="nav-left">
      <a href="index.html"><img src="images/logo.png" alt="Mintara logo"></a>
    </div>
    <div class="nav-right">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="videos.html">Videos</a>
      <a href="blog.html">Blog</a>
      <a href="contact.html">Contact</a>
      <span id="theme-toggle">ðŸŒ™</span>
    </div>
  </nav>

  <section class="hero fade-in" style="animation-delay:1.6s;">
    <!-- hero unchanged -->
  </section>

  <section class="features fade-in" style="animation-delay:1.9s;">
    <div class="feature-card" onclick="location.href='videos.html'" style="cursor:pointer;">
      <!-- Interactive Lessons unchanged -->
    </div>

    <div class="feature-card flip-card">
      <div class="flip-card-inner">
        <div class="flip-card-front">
          <!-- front unchanged -->
        </div>
        <div class="flip-card-back">
          <button class="tool-btn" id="btn-budget">Budgeting Calculator</button>
          <button class="tool-btn" id="btn-loan">Loan Schedule Tool</button>
          <button class="tool-btn" id="btn-npv">NPV & IRR Analyzer</button>
        </div>
      </div>
    </div>

    <div class="feature-card" onclick="location.href='contact.html'" style="cursor:pointer">
      <!-- Expert Tips unchanged -->
    </div>
  </section>

  <section class="testimonials fade-in" style="animation-delay:2.2s;">
    <!-- unchanged -->
  </section>

  <section class="cta-section fade-in" style="animation-delay:2.5s;">
    <!-- unchanged -->
  </section>

  <!-- popâ€‘up budgeting calculator window -->
  <div id="tool-window" class="tool-window hidden">
    <!-- unchanged -->
  </div>
  <div id="tool-minimized" class="tool-minimized hidden">Budgeting Calculator</div>

  <!-- popâ€‘up loan schedule window -->
  <div id="tool-window-loan" class="tool-window hidden">
    <!-- unchanged -->
  </div>
  <div id="tool-minimized-loan" class="tool-minimized hidden">Loan Schedule Tool</div>

  <!-- popâ€‘up NPV & IRR Analyzer -->
  <div id="tool-window-npv" class="tool-window hidden">
    <div class="tool-window-header">
      <span>NPV &amp; IRR Analyzer</span>
      <button id="minimize-npv">â€“</button>
      <button id="close-npv">Ã—</button>
    </div>
    <div class="tool-window-content">
      <form id="npv-form">
        <input type="number" step="0.01" id="npv-invest" placeholder="Initial Investment ($)" required>
        <input type="number" step="0.01" id="npv-rate"   placeholder="Discount Rate (%)"   required>
        <input type="text"           id="npv-flows" placeholder="Future Cash Flows (commaâ€‘sep)" required>
        <button type="submit">Calculate</button>
      </form>
      <div style="margin:1rem 0; text-align:center;">
        <p id="npv-result" style="font-weight:bold;"></p>
        <p id="irr-result" style="font-weight:bold;"></p>
      </div>
      <canvas id="npv-chart"></canvas>
    </div>
  </div>
  <div id="tool-minimized-npv" class="tool-minimized hidden">NPV &amp; IRR Analyzer</div>

  <footer class="fade-in" style="animation-delay:2.8s;">
    &copy; 2025 Mintara Finance Hub â€¢ <a href="index.html">Home</a>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Theme toggle unchanged...

      // Budgeting Calculator controls unchanged...

      // Budgeting Chart unchanged...

      // Loan Schedule Tool controls unchanged...

      // Loan amortization chart unchanged...

      // NPV & IRR Analyzer controls + calculation
      const btnNpv   = document.getElementById('btn-npv');
      const winNpv   = document.getElementById('tool-window-npv');
      const minNpv   = document.getElementById('minimize-npv');
      const closeNpv = document.getElementById('close-npv');
      const miniNpv  = document.getElementById('tool-minimized-npv');
      const formNpv  = document.getElementById('npv-form');

      btnNpv.addEventListener('click', () => {
        winNpv.classList.remove('hidden');
        miniNpv.classList.add('hidden');
      });
      minNpv.addEventListener('click', () => {
        winNpv.classList.add('hidden');
        miniNpv.classList.remove('hidden');
      });
      closeNpv.addEventListener('click', () => {
        winNpv.classList.add('hidden');
        miniNpv.classList.add('hidden');
      });
      miniNpv.addEventListener('click', () => {
        winNpv.classList.remove('hidden');
        miniNpv.classList.add('hidden');
      });

      function computeNPV(rate, flows) {
        return flows.reduce((sum, cf, i) => sum + cf / Math.pow(1 + rate, i), 0);
      }
      function computeIRR(flows) {
        let low = -0.9, high = 1.0, mid;
        for (let i = 0; i < 50; i++) {
          mid = (low + high) / 2;
          const fMid = flows.reduce((s, cf, idx) => s + cf / Math.pow(1 + mid, idx), 0);
          if (fMid > 0) low = mid; else high = mid;
        }
        return mid;
      }

      formNpv.addEventListener('submit', function(e) {
        e.preventDefault();
        const inv   = -Math.abs(parseFloat(this['npv-invest'].value));
        const rate  = parseFloat(this['npv-rate'].value) / 100;
        const flows = this['npv-flows'].value
                       .split(',')
                       .map(s => parseFloat(s.trim()))
                       .filter(n => !isNaN(n));
        const cash  = [inv, ...flows];

        const npv = computeNPV(rate, cash);
        const irr = computeIRR(cash) * 100;
        document.getElementById('npv-result').textContent = `NPV: $${npv.toFixed(2)}`;
        document.getElementById('irr-result').textContent = isNaN(irr)
          ? 'IRR: N/A'
          : `IRR: ${irr.toFixed(2)}%`;

        const pts   = 21;
        const maxR  = rate * 2;
        const labels = Array.from({length: pts}, (_, i) =>
          ((i / (pts - 1)) * maxR * 100).toFixed(1) + '%'
        );
        const data = labels.map(lbl =>
          computeNPV(parseFloat(lbl) / 100, cash)
        );

        if (window.npvChart) window.npvChart.destroy();
        window.npvChart = new Chart(
          document.getElementById('npv-chart'),
          {
            type: 'line',
            data: {
              labels,
              datasets: [{
                label: 'NPV vs Discount Rate',
                data,
                borderColor: '#3DDC97',
                backgroundColor: 'rgba(61,220,151,0.2)',
                fill: true
              }]
            },
            options: {
              scales: {
                y: { ticks: { color: '#FFFFFF' } },
                x: { ticks: { color: '#FFFFFF' } }
              },
              plugins: {
                legend: { labels: { color: '#FFFFFF' } },
                tooltip: {
                  titleColor: '#FFFFFF',
                  bodyColor: '#FFFFFF'
                }
              }
            }
          }
        );
      });
    });
  </script>
</body>
</html>
